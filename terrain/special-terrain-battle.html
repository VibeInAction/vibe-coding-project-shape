<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>特殊地形战场 - 几何境域：形态之战</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes stormMove {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        @keyframes portalGlow {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }
        @keyframes morphShift {
            0%, 100% { border-radius: 50%; }
            25% { border-radius: 20%; }
            50% { border-radius: 40%; }
            75% { border-radius: 30%; }
        }
        @keyframes timeFlow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }
        .storm-area {
            animation: stormMove 8s linear infinite;
        }
        .portal {
            animation: portalGlow 3s ease-in-out infinite;
        }
        .morph-zone {
            animation: morphShift 5s ease-in-out infinite;
        }
        .time-rift {
            animation: timeFlow 10s linear infinite;
        }
        .tooltip {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip-trigger:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
        .resource-icon {
            filter: drop-shadow(0 0 3px rgba(255,255,255,0.8));
        }
        .minimap {
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }
        .zone-indicator {
            transition: all 0.3s ease;
        }
        .zone-indicator:hover {
            transform: scale(1.1);
            filter: brightness(1.3);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <!-- Header -->
    <header class="bg-gray-800 border-b border-gray-700">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <a href="index.html" class="text-blue-400 hover:text-blue-300">
                        <i class="fas fa-arrow-left"></i> 返回地形地图
                    </a>
                    <h1 class="text-2xl font-bold">特殊地形战场</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-sm bg-purple-600 px-3 py-1 rounded-full">
                        <i class="fas fa-star"></i> 实验性战场
                    </span>
                    <button onclick="toggleFullscreen()" class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-expand"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- Battle Map -->
            <div class="lg:col-span-3">
                <div class="bg-gray-800 rounded-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold">战场概览</h2>
                        <div class="flex space-x-2">
                            <button onclick="toggleLayer('terrain')" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition">
                                <i class="fas fa-mountain"></i> 地形
                            </button>
                            <button onclick="toggleLayer('resources')" class="bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-sm transition">
                                <i class="fas fa-gem"></i> 资源
                            </button>
                            <button onclick="toggleLayer('strategic')" class="bg-purple-600 hover:bg-purple-700 px-3 py-1 rounded text-sm transition">
                                <i class="fas fa-chess"></i> 战略
                            </button>
                        </div>
                    </div>

                    <!-- SVG Battle Map -->
                    <div class="relative bg-gray-900 rounded-lg overflow-hidden" style="height: 600px;">
                        <svg viewBox="0 0 1200 600" class="w-full h-full">
                            <!-- Background -->
                            <rect width="1200" height="600" fill="#1a1a2e"/>

                            <!-- Storm Canyon -->
                            <g id="storm-canyon">
                                <path d="M0 150 Q300 120 600 180 T1200 150 L1200 250 Q900 280 600 220 T0 250 Z" 
                                      fill="#2d1b4e" stroke="#7c3aed" stroke-width="2"/>
                                <g class="storm-area">
                                    <circle cx="100" cy="200" r="30" fill="#9333ea" opacity="0.6"/>
                                    <circle cx="400" cy="190" r="40" fill="#a855f7" opacity="0.5"/>
                                    <circle cx="700" cy="210" r="35" fill="#9333ea" opacity="0.6"/>
                                    <circle cx="1000" cy="195" r="45" fill="#a855f7" opacity="0.5"/>
                                </g>
                                <text x="600" y="205" text-anchor="middle" fill="#e9d5ff" font-size="14" font-weight="bold">
                                    几何风暴峡谷
                                </text>
                            </g>

                            <!-- Morph Testing Ground -->
                            <g id="morph-ground" transform="translate(0, 300)">
                                <rect x="100" y="0" width="400" height="200" fill="#1e3a1e" stroke="#22c55e" stroke-width="2" rx="10"/>
                                <g class="morph-zone">
                                    <circle cx="300" cy="100" r="80" fill="#16a34a" opacity="0.6"/>
                                    <path d="M200 50 L400 50 L350 150 L250 150 Z" fill="#15803d" opacity="0.5"/>
                                    <rect x="250" y="75" width="100" height="50" fill="#166534" opacity="0.6"/>
                                </g>
                                <text x="300" y="105" text-anchor="middle" fill="#bbf7d0" font-size="14" font-weight="bold">
                                    形态试验场
                                </text>
                            </g>

                            <!-- Time Rift -->
                            <g id="time-rift" transform="translate(700, 300)">
                                <rect x="0" y="0" width="400" height="200" fill="#312e81" stroke="#6366f1" stroke-width="2" rx="10"/>
                                <g class="time-rift">
                                    <circle cx="200" cy="100" r="60" fill="#4f46e5" opacity="0.7"/>
                                    <circle cx="150" cy="100" r="40" fill="#6366f1" opacity="0.5"/>
                                    <circle cx="250" cy="100" r="40" fill="#818cf8" opacity="0.5"/>
                                    <path d="M200 40 L240 100 L200 160 L160 100 Z" fill="#a5b4fc" opacity="0.6"/>
                                </g>
                                <text x="200" y="105" text-anchor="middle" fill="#c7d2fe" font-size="14" font-weight="bold">
                                    时间裂隙
                                </text>
                            </g>

                            <!-- Spawn Points -->
                            <g id="spawn-points">
                                <g class="tooltip-trigger" transform="translate(150, 350)">
                                    <circle r="20" fill="#ef4444" stroke="#fff" stroke-width="2"/>
                                    <text y="5" text-anchor="middle" fill="#fff" font-size="12" font-weight="bold">P1</text>
                                    <text y="-30" text-anchor="middle" fill="#ef4444" font-size="12">玩家1</text>
                                    <g class="tooltip absolute bg-gray-800 px-2 py-1 rounded text-xs">
                                        <text x="0" y="20">形态试验场入口</text>
                                    </g>
                                </g>

                                <g class="tooltip-trigger" transform="translate(850, 350)">
                                    <circle r="20" fill="#3b82f6" stroke="#fff" stroke-width="2"/>
                                    <text y="5" text-anchor="middle" fill="#fff" font-size="12" font-weight="bold">P2</text>
                                    <text y="-30" text-anchor="middle" fill="#3b82f6" font-size="12">玩家2</text>
                                    <g class="tooltip absolute bg-gray-800 px-2 py-1 rounded text-xs">
                                        <text x="0" y="20">时间裂隙入口</text>
                                    </g>
                                </g>

                                <g class="tooltip-trigger" transform="translate(100, 100)">
                                    <circle r="20" fill="#10b981" stroke="#fff" stroke-width="2"/>
                                    <text y="5" text-anchor="middle" fill="#fff" font-size="12" font-weight="bold">P3</text>
                                    <text y="-30" text-anchor="middle" fill="#10b981" font-size="12">玩家3</text>
                                    <g class="tooltip absolute bg-gray-800 px-2 py-1 rounded text-xs">
                                        <text x="0" y="20">风暴峡谷入口</text>
                                    </g>
                                </g>

                                <g class="tooltip-trigger" transform="translate(1100, 100)">
                                    <circle r="20" fill="#f59e0b" stroke="#fff" stroke-width="2"/>
                                    <text y="5" text-anchor="middle" fill="#fff" font-size="12" font-weight="bold">P4</text>
                                    <text y="-30" text-anchor="middle" fill="#f59e0b" font-size="12">玩家4</text>
                                    <g class="tooltip absolute bg-gray-800 px-2 py-1 rounded text-xs">
                                        <text x="0" y="20">风暴峡谷远端</text>
                                    </g>
                                </g>
                            </g>

                            <!-- Portals -->
                            <g id="portals">
                                <g class="tooltip-trigger portal" transform="translate(300, 100)">
                                    <circle r="25" fill="#8b5cf6" stroke="#a78bfa" stroke-width="3"/>
                                    <circle r="15" fill="#7c3aed" opacity="0.8"/>
                                    <text y="5" text-anchor="middle" fill="#fff" font-size="10">传送</text>
                                    <g class="tooltip absolute bg-gray-800 px-2 py-1 rounded text-xs">
                                        <text x="0" y="40">随机传送门</text>
                                    </g>
                                </g>

                                <g class="tooltip-trigger portal" transform="translate(900, 100)">
                                    <circle r="25" fill="#8b5cf6" stroke="#a78bfa" stroke-width="3"/>
                                    <circle r="15" fill="#7c3aed" opacity="0.8"/>
                                    <text y="5" text-anchor="middle" fill="#fff" font-size="10">传送</text>
                                    <g class="tooltip absolute bg-gray-800 px-2 py-1 rounded text-xs">
                                        <text x="0" y="40">随机传送门</text>
                                    </g>
                                </g>

                                <g class="tooltip-trigger portal" transform="translate(550, 300)">
                                    <circle r="25" fill="#8b5cf6" stroke="#a78bfa" stroke-width="3"/>
                                    <circle r="15" fill="#7c3aed" opacity="0.8"/>
                                    <text y="5" text-anchor="middle" fill="#fff" font-size="10">传送</text>
                                    <g class="tooltip absolute bg-gray-800 px-2 py-1 rounded text-xs">
                                        <text x="0" y="40">中央传送门</text>
                                    </g>
                                </g>
                            </g>

                            <!-- Resources -->
                            <g id="resources">
                                <!-- Storm Resources -->
                                <g class="tooltip-trigger" transform="translate(200, 200)">
                                    <g class="resource-icon">
                                        <path d="M-10,-5 L10,-5 L5,10 L-5,10 Z" fill="#eab308"/>
                                        <circle cx="0" cy="0" r="8" fill="#facc15"/>
                                    </g>
                                    <text y="20" text-anchor="middle" fill="#fef3c7" font-size="10">风暴能源</text>
                                    <g class="tooltip absolute bg-gray-800 px-2 py-1 rounded text-xs">
                                        <text x="0" y="25">+5 能量/秒</text>
                                        <text x="0" y="40">风险：随机传送</text>
                                    </g>
                                </g>

                                <!-- Morph Resources -->
                                <g class="tooltip-trigger" transform="translate(300, 350)">
                                    <g class="resource-icon">
                                        <rect x="-10" y="-10" width="20" height="20" fill="#22c55e"/>
                                        <circle cx="0" cy="0" r="8" fill="#4ade80"/>
                                    </g>
                                    <text y="25" text-anchor="middle" fill="#bbf7d0" font-size="10">形态水晶</text>
                                    <g class="tooltip absolute bg-gray-800 px-2 py-1 rounded text-xs">
                                        <text x="0" y="25">随机变形效果</text>
                                        <text x="0" y="40">持续30秒</text>
                                    </g>
                                </g>

                                <!-- Time Resources -->
                                <g class="tooltip-trigger" transform="translate(900, 350)">
                                    <g class="resource-icon">
                                        <polygon points="0,-12 10,6 -10,6" fill="#6366f1"/>
                                        <circle cx="0" cy="0" r="8" fill="#818cf8"/>
                                    </g>
                                    <text y="25" text-anchor="middle" fill="#c7d2fe" font-size="10">时间碎片</text>
                                    <g class="tooltip absolute bg-gray-800 px-2 py-1 rounded text-xs">
                                        <text x="0" y="25">时间加速/减速</text>
                                        <text x="0" y="40">影响附近单位</text>
                                    </g>
                                </g>
                            </g>

                            <!-- Dynamic Elements -->
                            <g id="dynamic-elements">
                                <!-- Storm Effect -->
                                <g opacity="0.3">
                                    <path d="M50 150 Q150 140 250 160" stroke="#9333ea" stroke-width="20" fill="none">
                                        <animate attributeName="d" 
                                                 values="M50 150 Q150 140 250 160;
                                                         M50 160 Q150 150 250 140;
                                                         M50 150 Q150 140 250 160"
                                                 dur="3s" repeatCount="indefinite"/>
                                    </path>
                                </g>

                                <!-- Morph Animation -->
                                <g transform="translate(300, 400)">
                                    <rect x="-30" y="-30" width="60" height="60" fill="#22c55e" opacity="0.5">
                                        <animate attributeName="rx" values="0;30;0" dur="4s" repeatCount="indefinite"/>
                                        <animate attributeName="ry" values="30;0;30" dur="4s" repeatCount="indefinite"/>
                                    </rect>
                                </g>

                                <!-- Time Ripple -->
                                <g transform="translate(900, 400)">
                                    <circle r="0" fill="none" stroke="#6366f1" stroke-width="2" opacity="0.8">
                                        <animate attributeName="r" values="0;50;0" dur="2s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" values="0.8;0;0.8" dur="2s" repeatCount="indefinite"/>
                                    </circle>
                                </g>
                            </g>
                        </svg>

                        <!-- Minimap -->
                        <div class="absolute bottom-4 right-4 w-48 h-24 bg-gray-800 rounded minimap">
                            <svg viewBox="0 0 1200 600" class="w-full h-full">
                                <!-- Simplified minimap content -->
                                <rect x="0" y="150" width="1200" height="100" fill="#9333ea" opacity="0.3"/>
                                <rect x="100" y="300" width="400" height="200" fill="#22c55e" opacity="0.3"/>
                                <rect x="700" y="300" width="400" height="200" fill="#6366f1" opacity="0.3"/>
                                <!-- Spawn points -->
                                <circle cx="150" cy="350" r="5" fill="#ef4444"/>
                                <circle cx="850" cy="350" r="5" fill="#3b82f6"/>
                                <circle cx="100" cy="100" r="5" fill="#10b981"/>
                                <circle cx="1100" cy="100" r="5" fill="#f59e0b"/>
                            </svg>
                        </div>

                        <!-- Zone Indicators -->
                        <div class="absolute top-4 left-4 bg-gray-800 bg-opacity-90 rounded-lg p-3">
                            <h3 class="text-sm font-bold mb-2">区域状态</h3>
                            <div class="space-y-1 text-xs">
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-purple-600 rounded-full zone-indicator"></div>
                                    <span>风暴峡谷: 活跃</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-green-600 rounded-full zone-indicator"></div>
                                    <span>形态试验场: 变形中</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-indigo-600 rounded-full zone-indicator"></div>
                                    <span>时间裂隙: 流动</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Battle Info -->
                    <div class="mt-4 grid grid-cols-3 gap-4">
                        <div class="bg-gray-700 rounded-lg p-3">
                            <h3 class="text-sm font-semibold text-purple-400 mb-1">几何风暴峡谷</h3>
                            <p class="text-xs text-gray-300">周期性改变的地形，移动的能量风暴，每30秒变化一次</p>
                        </div>
                        <div class="bg-gray-700 rounded-lg p-3">
                            <h3 class="text-sm font-semibold text-green-400 mb-1">形态试验场</h3>
                            <p class="text-xs text-gray-300">随机地形生成，实验性形态效果，单位随机变形</p>
                        </div>
                        <div class="bg-gray-700 rounded-lg p-3">
                            <h3 class="text-sm font-semibold text-indigo-400 mb-1">时间裂隙</h3>
                            <p class="text-xs text-gray-300">时间加速/减速区，时间回溯点，召唤过去/未来单位</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Side Panel -->
            <div class="space-y-6">
                <!-- Map Info -->
                <div class="bg-gray-800 rounded-lg p-4">
                    <h3 class="text-lg font-semibold mb-3">战场信息</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-400">地图类型</span>
                            <span>特殊地形</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">玩家数量</span>
                            <span>2-4</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">游戏时长</span>
                            <span>15-30分钟</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">难度等级</span>
                            <span class="text-yellow-400">★★★★★</span>
                        </div>
                    </div>
                </div>

                <!-- Victory Conditions -->
                <div class="bg-gray-800 rounded-lg p-4">
                    <h3 class="text-lg font-semibold mb-3">胜利条件</h3>
                    <ul class="space-y-2 text-sm">
                        <li class="flex items-start">
                            <i class="fas fa-trophy text-yellow-400 mt-1 mr-2"></i>
                            <span>占领所有3个特殊区域</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-clock text-blue-400 mt-1 mr-2"></i>
                            <span>在时间裂隙中生存10分钟</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-magic text-purple-400 mt-1 mr-2"></i>
                            <span>收集5个时间碎片</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-skull text-red-400 mt-1 mr-2"></i>
                            <span>消灭所有敌人</span>
                        </li>
                    </ul>
                </div>

                <!-- Race Bonuses -->
                <div class="bg-gray-800 rounded-lg p-4">
                    <h3 class="text-lg font-semibold mb-3">种族优势</h3>
                    <div class="space-y-3">
                        <div>
                            <h4 class="text-sm font-semibold text-blue-400 mb-1">方形族</h4>
                            <p class="text-xs text-gray-300">形态变形抗性+50%</p>
                        </div>
                        <div>
                            <h4 class="text-sm font-semibold text-green-400 mb-1">三角族</h4>
                            <p class="text-xs text-gray-300">风暴移动速度+30%</p>
                        </div>
                        <div>
                            <h4 class="text-sm font-semibold text-purple-400 mb-1">圆形族</h4>
                            <p class="text-xs text-gray-300">时间效果持续时间+40%</p>
                        </div>
                        <div>
                            <h4 class="text-sm font-semibold text-red-400 mb-1">多边形族</h4>
                            <p class="text-xs text-gray-300">传送门使用冷却-50%</p>
                        </div>
                    </div>
                </div>

                <!-- Dynamic Effects -->
                <div class="bg-gray-800 rounded-lg p-4">
                    <h3 class="text-lg font-semibold mb-3">动态效果</h3>
                    <div class="space-y-2 text-sm">
                        <div class="bg-purple-900 bg-opacity-50 rounded p-2">
                            <div class="flex justify-between items-center">
                                <span class="text-purple-300">风暴周期</span>
                                <span id="storm-timer" class="font-mono">00:30</span>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-1 mt-1">
                                <div id="storm-progress" class="bg-purple-500 h-1 rounded-full" style="width: 100%"></div>
                            </div>
                        </div>
                        <div class="bg-green-900 bg-opacity-50 rounded p-2">
                            <div class="flex justify-between items-center">
                                <span class="text-green-300">形态变化</span>
                                <span id="morph-timer" class="font-mono">00:15</span>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-1 mt-1">
                                <div id="morph-progress" class="bg-green-500 h-1 rounded-full" style="width: 75%"></div>
                            </div>
                        </div>
                        <div class="bg-indigo-900 bg-opacity-50 rounded p-2">
                            <div class="flex justify-between items-center">
                                <span class="text-indigo-300">时间流动</span>
                                <span id="time-timer" class="font-mono">01:00</span>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-1 mt-1">
                                <div id="time-progress" class="bg-indigo-500 h-1 rounded-full" style="width: 50%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Timer management
        let stormTime = 30;
        let morphTime = 15;
        let timeTime = 60;

        function updateTimers() {
            // Storm timer
            stormTime--;
            if (stormTime <= 0) stormTime = 30;
            document.getElementById('storm-timer').textContent = `00:${stormTime.toString().padStart(2, '0')}`;
            document.getElementById('storm-progress').style.width = `${(stormTime / 30) * 100}%`;

            // Morph timer
            morphTime--;
            if (morphTime <= 0) morphTime = 30;
            document.getElementById('morph-timer').textContent = `00:${morphTime.toString().padStart(2, '0')}`;
            document.getElementById('morph-progress').style.width = `${(morphTime / 30) * 100}%`;

            // Time timer
            timeTime--;
            if (timeTime <= 0) timeTime = 60;
            document.getElementById('time-timer').textContent = `01:${(timeTime % 60).toString().padStart(2, '0')}`;
            document.getElementById('time-progress').style.width = `${(timeTime / 60) * 100}%`;
        }

        setInterval(updateTimers, 1000);

        // Layer toggle
        function toggleLayer(layer) {
            const element = document.getElementById(layer);
            if (element) {
                element.style.display = element.style.display === 'none' ? 'block' : 'none';
            }
        }

        // Fullscreen
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // Interactive tooltips
        document.querySelectorAll('.tooltip-trigger').forEach(trigger => {
            trigger.addEventListener('mouseenter', (e) => {
                const tooltip = trigger.querySelector('.tooltip');
                if (tooltip) {
                    const rect = trigger.getBoundingClientRect();
                    tooltip.style.position = 'absolute';
                    tooltip.style.left = '50%';
                    tooltip.style.bottom = '100%';
                    tooltip.style.transform = 'translateX(-50%)';
                    tooltip.style.marginBottom = '5px';
                }
            });
        });
    </script>
</body>
</html>