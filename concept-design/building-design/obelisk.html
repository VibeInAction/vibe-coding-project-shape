<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–¹å°–ç¢‘ - æ–¹ç¢‘ç›Ÿçº¦å»ºç­‘è®¾è®¡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+SC:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* æ–¹ç¢‘ç›Ÿçº¦é¢œè‰²ä¸»é¢˜ */
            --square-color: #10b981;
            --square-light: #34d399;
            --square-dark: #059669;
            
            /* é€šç”¨é¢œè‰² */
            --dark-bg: #0f172a;
            --card-bg: rgba(30, 41, 59, 0.8);
            --border-color: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: var(--dark-bg);
            color: #e2e8f0;
        }

        .font-orbitron {
            font-family: 'Orbitron', sans-serif;
        }

        /* ä¸»æ ‡é¢˜æ ·å¼ */
        .main-title {
            background: linear-gradient(135deg, var(--square-color) 0%, var(--square-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* å»ºç­‘å¡ç‰‡æ ·å¼ */
        .building-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            transition: all 0.3s ease;
        }

        .building-card:hover {
            transform: translateY(-4px);
            border-color: var(--square-color);
            box-shadow: 0 20px 40px rgba(16, 185, 129, 0.3);
        }

        /* å‚æ•°æ¡æ ·å¼ */
        .parameter-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .parameter-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .parameter-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* å‡çº§èŠ‚ç‚¹æ ·å¼ */
        .upgrade-node {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .upgrade-node:hover {
            transform: scale(1.1);
            border-color: var(--square-color);
        }

        .upgrade-node.active {
            background: var(--square-color);
            color: white;
        }

        /* 3Då±•ç¤ºå®¹å™¨ */
        .model-container {
            width: 100%;
            height: 400px;
            background: radial-gradient(ellipse at center, rgba(16, 185, 129, 0.1) 0%, transparent 70%);
            border-radius: 1rem;
            position: relative;
            overflow: hidden;
        }

        /* æ¨¡å—æ’æ§½ */
        .module-slot {
            width: 80px;
            height: 80px;
            background: rgba(30, 41, 59, 0.5);
            border: 2px dashed rgba(16, 185, 129, 0.5);
            border-radius: 0.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .module-slot:hover {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--square-color);
            transform: scale(1.05);
        }

        .module-slot.equipped {
            background: rgba(16, 185, 129, 0.2);
            border-style: solid;
            border-color: var(--square-color);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }

        /* é‡å­è®¡ç®—æ•ˆæœ */
        .quantum-effect {
            position: absolute;
            width: 100px;
            height: 100px;
            border: 2px solid var(--square-color);
            border-radius: 50%;
            opacity: 0;
            animation: quantum-pulse 2s ease-out infinite;
        }

        @keyframes quantum-pulse {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(2);
                opacity: 0;
            }
        }

        /* æ•°æ®æµæ•ˆæœ */
        .data-stream {
            position: absolute;
            width: 2px;
            height: 20px;
            background: linear-gradient(to bottom, transparent, var(--square-color), transparent);
            opacity: 0.6;
            animation: data-flow 2s linear infinite;
        }

        @keyframes data-flow {
            0% { transform: translateY(-20px); }
            100% { transform: translateY(20px); }
        }

        /* åŠŸèƒ½åˆ‡æ¢æ ‡ç­¾ */
        .function-tab {
            background: rgba(30, 41, 59, 0.5);
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 0.5rem 0.5rem 0 0;
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .function-tab:hover {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--square-color);
        }

        .function-tab.active {
            background: rgba(16, 185, 129, 0.2);
            border-color: var(--square-color);
            border-bottom-color: transparent;
        }

        /* ç ”ç©¶è¿›åº¦æ¡ */
        .research-progress {
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .research-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--square-color), var(--square-light));
            border-radius: 12px;
            transition: width 0.1s linear;
            position: relative;
        }

        .research-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
            animation: research-shimmer 1s linear infinite;
        }

        @keyframes research-shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* äº¤äº’æŒ‰é’® */
        .action-button {
            background: linear-gradient(135deg, var(--square-color) 0%, var(--square-dark) 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.4);
        }

        .action-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .action-button:hover::before {
            width: 300px;
            height: 300px;
        }

        /* æ¨¡å—é€‰æ‹©å™¨ */
        .module-selector {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            max-height: 400px;
            overflow-y: auto;
        }

        .module-item {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .module-item:hover {
            background: rgba(16, 185, 129, 0.2);
            border-color: var(--square-color);
            transform: translateX(4px);
        }

        .module-item.selected {
            background: rgba(16, 185, 129, 0.3);
            border-color: var(--square-color);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }

        /* é¢„æµ‹æŒ‡ç¤ºå™¨ */
        .prediction-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 9999px;
            font-size: 0.875rem;
        }

        .prediction-indicator.high {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
        }

        .prediction-indicator.medium {
            background: rgba(245, 158, 11, 0.1);
            border-color: rgba(245, 158, 11, 0.3);
        }

        .prediction-indicator.low {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
        }
    </style>
</head>
<body>
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <header class="text-center mb-8">
            <h1 class="font-orbitron text-4xl font-bold main-title mb-2">æ–¹å°–ç¢‘</h1>
            <p class="text-gray-400">Obelisk - é‡å­è®¡ç®—ä¸æ¨¡å—åŒ–æ¢çº½</p>
        </header>

        <!-- ä¸»è¦å†…å®¹åŒº -->
        <div class="grid lg:grid-cols-2 gap-8">
            <!-- å·¦ä¾§ï¼š3Då±•ç¤ºå’Œæ§åˆ¶ -->
            <div class="space-y-6">
                <!-- 3Dæ¨¡å‹å±•ç¤º -->
                <div class="building-card p-6">
                    <div class="model-container" id="model-container">
                        <!-- Three.js 3Dåœºæ™¯å°†åœ¨è¿™é‡Œæ¸²æŸ“ -->
                    </div>
                    <div class="mt-4 flex justify-center space-x-4">
                        <button class="action-button" onclick="toggleRotation()">
                            <span id="rotation-text">æš‚åœæ—‹è½¬</span>
                        </button>
                        <button class="action-button" onclick="toggleQuantumMode()">
                            <span id="quantum-text">é‡å­æ¨¡å¼</span>
                        </button>
                    </div>
                </div>

                <!-- æ¨¡å—é…ç½® -->
                <div class="building-card p-6">
                    <h3 class="font-orbitron text-xl font-bold mb-4">æ¨¡å—é…ç½®</h3>
                    <div class="grid grid-cols-3 gap-4 mb-4">
                        <div class="module-slot" onclick="openModuleSelector(0)">
                            <span class="text-2xl">âš¡</span>
                            <span class="text-xs mt-1">èƒ½é‡æ¨¡å—</span>
                        </div>
                        <div class="module-slot equipped" onclick="openModuleSelector(1)">
                            <span class="text-2xl">ğŸ”¬</span>
                            <span class="text-xs mt-1">ç ”ç©¶æ¨¡å—</span>
                        </div>
                        <div class="module-slot" onclick="openModuleSelector(2)">
                            <span class="text-2xl">ğŸ›¡ï¸</span>
                            <span class="text-xs mt-1">é˜²å¾¡æ¨¡å—</span>
                        </div>
                        <div class="module-slot equipped" onclick="openModuleSelector(3)">
                            <span class="text-2xl">ğŸ“¡</span>
                            <span class="text-xs mt-1">é€šè®¯æ¨¡å—</span>
                        </div>
                        <div class="module-slot" onclick="openModuleSelector(4)">
                            <span class="text-2xl">âš™ï¸</span>
                            <span class="text-xs mt-1">å·¥ç¨‹æ¨¡å—</span>
                        </div>
                        <div class="module-slot" onclick="openModuleSelector(5)">
                            <span class="text-2xl">ğŸ”®</span>
                            <span class="text-xs mt-1">é¢„æµ‹æ¨¡å—</span>
                        </div>
                    </div>
                    <div class="text-center">
                        <span class="text-sm text-gray-400">å·²è£…å¤‡: <span id="equipped-count" class="text-green-400">2</span>/6 æ¨¡å—</span>
                    </div>
                </div>

                <!-- é‡å­è®¡ç®—æ¼”ç¤º -->
                <div class="building-card p-6">
                    <h3 class="font-orbitron text-xl font-bold mb-4">é‡å­è®¡ç®—çŠ¶æ€</h3>
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between mb-2">
                                <span>è®¡ç®—è¿›åº¦</span>
                                <span id="compute-percent">0%</span>
                            </div>
                            <div class="research-progress">
                                <div class="research-fill" id="compute-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm mb-2">è®¡ç®—å¤æ‚åº¦</label>
                            <select id="complexity" class="w-full p-2 bg-gray-800 rounded" onchange="updateComplexity()">
                                <option value="simple">ç®€å•è®¡ç®—</option>
                                <option value="medium">ä¸­ç­‰å¤æ‚åº¦</option>
                                <option value="complex">å¤æ‚è®¡ç®—</option>
                                <option value="quantum">é‡å­çº ç¼ </option>
                            </select>
                        </div>
                        <div class="text-center">
                            <button class="action-button" onclick="startComputation()">
                                å¼€å§‹è®¡ç®—
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šå»ºç­‘ä¿¡æ¯ -->
            <div class="space-y-6">
                <!-- åŸºç¡€ä¿¡æ¯ -->
                <div class="building-card p-6">
                    <h3 class="font-orbitron text-xl font-bold mb-4">å»ºç­‘ä¿¡æ¯</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <p class="text-sm text-gray-400">ç§æ—</p>
                            <p class="font-semibold">æ–¹ç¢‘ç›Ÿçº¦</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-400">å»ºç­‘ç±»å‹</p>
                            <p class="font-semibold">å¤šåŠŸèƒ½å»ºç­‘</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-400">å»ºé€ æ—¶é—´</p>
                            <p class="font-semibold">240ç§’</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-400">å ç”¨äººå£</p>
                            <p class="font-semibold">6</p>
                        </div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-gray-700">
                        <p class="text-gray-300 leading-relaxed">
                            æ–¹å°–ç¢‘æ˜¯æ–¹ç¢‘ç›Ÿçº¦çš„æ ¸å¿ƒå»ºç­‘ï¼Œé€šè¿‡æ¨¡å—åŒ–è®¾è®¡å®ç°å¤šç§åŠŸèƒ½ã€‚
                            é›†æˆäº†é‡å­è®¡ç®—æŠ€æœ¯ï¼Œèƒ½å¤Ÿè¿›è¡Œå¤æ‚çš„ç ”ç©¶å’Œé¢„æµ‹ã€‚
                        </p>
                    </div>
                </div>

                <!-- åŠŸèƒ½åˆ‡æ¢ -->
                <div class="building-card p-6">
                    <h3 class="font-orbitron text-xl font-bold mb-4">åŠŸèƒ½æ¨¡å¼</h3>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <div class="function-tab active" onclick="switchFunction('research')">
                            ç ”ç©¶æ¨¡å¼
                        </div>
                        <div class="function-tab" onclick="switchFunction('defense')">
                            é˜²å¾¡æ¨¡å¼
                        </div>
                        <div class="function-tab" onclick="switchFunction('communication')">
                            é€šè®¯æ¨¡å¼
                        </div>
                        <div class="function-tab" onclick="switchFunction('engineering')">
                            å·¥ç¨‹æ¨¡å¼
                        </div>
                    </div>
                    <div id="function-content" class="p-4 bg-gray-800/50 rounded-lg">
                        <h4 class="font-bold mb-2">ç ”ç©¶æ¨¡å¼</h4>
                        <p class="text-sm text-gray-400 mb-3">
                            åŠ é€Ÿç§‘æŠ€ç ”ç©¶ï¼Œæä¾›ç ”ç©¶ç‚¹æ•°åŠ æˆ
                        </p>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div>
                                <span class="text-gray-400">ç ”ç©¶é€Ÿåº¦:</span>
                                <span class="text-green-400">+50%</span>
                            </div>
                            <div>
                                <span class="text-gray-400">æ•ˆç‡:</span>
                                <span class="text-green-400">85%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å»ºç­‘å‚æ•° -->
                <div class="building-card p-6">
                    <h3 class="font-orbitron text-xl font-bold mb-4">å»ºç­‘å‚æ•°</h3>
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>ç”Ÿå‘½å€¼</span>
                                <span id="health-text">2000/2000</span>
                            </div>
                            <div class="parameter-bar">
                                <div class="parameter-fill bg-green-500" id="health-bar" style="width: 100%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>æŠ¤ç›¾å€¼</span>
                                <span id="shield-text">1000/1000</span>
                            </div>
                            <div class="parameter-bar">
                                <div class="parameter-fill bg-blue-500" id="shield-bar" style="width: 100%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>èƒ½é‡è¾“å‡º</span>
                                <span id="energy-text">150/150</span>
                            </div>
                            <div class="parameter-bar">
                                <div class="parameter-fill bg-purple-500" id="energy-bar" style="width: 100%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>è®¡ç®—èƒ½åŠ›</span>
                                <span id="compute-text">1000 TFLOPS</span>
                            </div>
                            <div class="parameter-bar">
                                <div class="parameter-fill bg-cyan-500" id="compute-bar" style="width: 80%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å‡çº§ç³»ç»Ÿ -->
                <div class="building-card p-6">
                    <h3 class="font-orbitron text-xl font-bold mb-4">å‡çº§è·¯å¾„</h3>
                    <div class="flex items-center justify-between mb-4">
                        <div class="upgrade-node active" onclick="selectUpgrade(0)">
                            <span class="font-bold">T1</span>
                        </div>
                        <div class="flex-1 h-0.5 bg-gray-600"></div>
                        <div class="upgrade-node" onclick="selectUpgrade(1)">
                            <span class="font-bold">T2</span>
                        </div>
                        <div class="flex-1 h-0.5 bg-gray-600"></div>
                        <div class="upgrade-node" onclick="selectUpgrade(2)">
                            <span class="font-bold">T3</span>
                        </div>
                    </div>
                    <div class="p-4 bg-gray-800 rounded-lg">
                        <h4 class="font-bold mb-2" id="upgrade-title">T1 - åŸºç¡€æ–¹å°–ç¢‘</h4>
                        <p class="text-sm text-gray-400 mb-2" id="upgrade-desc">æ ‡å‡†çš„æ¨¡å—åŒ–æ–¹å°–ç¢‘</p>
                        <div class="flex justify-between items-center">
                            <span>å‡çº§è´¹ç”¨</span>
                            <span id="upgrade-cost" class="font-semibold">2000 å½¢é­„</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- é¢„æµ‹åŠŸèƒ½ -->
        <div class="mt-8 building-card p-6">
            <h3 class="font-orbitron text-xl font-bold mb-4">é‡å­é¢„æµ‹ç³»ç»Ÿ</h3>
            <div class="grid md:grid-cols-3 gap-6">
                <div>
                    <h4 class="font-semibold mb-3">é¢„æµ‹ç±»å‹</h4>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="radio" name="prediction" value="battle" checked class="mr-2">
                            <span>æˆ˜å†µé¢„æµ‹</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="prediction" value="resource" class="mr-2">
                            <span>èµ„æºé¢„æµ‹</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="prediction" value="enemy" class="mr-2">
                            <span>æ•Œå†›åŠ¨å‘</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="prediction" value="weather" class="mr-2">
                            <span>ç¯å¢ƒå˜åŒ–</span>
                        </label>
                    </div>
                </div>
                <div>
                    <h4 class="font-semibold mb-3">é¢„æµ‹ç»“æœ</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <span>èƒœç‡</span>
                            <div class="prediction-indicator high">
                                <span>87%</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span>é£é™©ç­‰çº§</span>
                            <div class="prediction-indicator medium">
                                <span>ä¸­ç­‰</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span>å»ºè®®è¡ŒåŠ¨</span>
                            <div class="prediction-indicator low">
                                <span>è¿›æ”»</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <h4 class="font-semibold mb-3">æ“ä½œ</h4>
                    <button class="action-button w-full mb-2" onclick="runPrediction()">
                        è¿è¡Œé¢„æµ‹
                    </button>
                    <div class="text-xs text-gray-400">
                        å‡†ç¡®åº¦: <span class="text-green-400">92%</span> | 
                        è€—æ—¶: <span class="text-blue-400">5ç§’</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ¨¡å—é€‰æ‹©å™¨ï¼ˆéšè—ï¼‰ -->
        <div id="module-selector" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="module-selector max-w-md w-full mx-4">
                <h3 class="font-orbitron text-xl font-bold mb-4">é€‰æ‹©æ¨¡å—</h3>
                <div id="module-list">
                    <div class="module-item" onclick="selectModule('energy')">
                        <h4 class="font-bold">èƒ½é‡æ¨¡å—</h4>
                        <p class="text-sm text-gray-400">å¢åŠ èƒ½é‡äº§å‡ºå’Œå­˜å‚¨</p>
                    </div>
                    <div class="module-item selected" onclick="selectModule('research')">
                        <h4 class="font-bold">ç ”ç©¶æ¨¡å—</h4>
                        <p class="text-sm text-gray-400">åŠ é€Ÿç§‘æŠ€ç ”ç©¶è¿›åº¦</p>
                    </div>
                    <div class="module-item" onclick="selectModule('defense')">
                        <h4 class="font-bold">é˜²å¾¡æ¨¡å—</h4>
                        <p class="text-sm text-gray-400">å¢å¼ºé˜²å¾¡ç³»ç»Ÿå’ŒæŠ¤ç›¾</p>
                    </div>
                    <div class="module-item selected" onclick="selectModule('communication')">
                        <h4 class="font-bold">é€šè®¯æ¨¡å—</h4>
                        <p class="text-sm text-gray-400">æ‰©å±•é€šè®¯èŒƒå›´å’Œæ•ˆç‡</p>
                    </div>
                    <div class="module-item" onclick="selectModule('engineering')">
                        <h4 class="font-bold">å·¥ç¨‹æ¨¡å—</h4>
                        <p class="text-sm text-gray-400">æå‡å»ºç­‘å’Œç»´ä¿®é€Ÿåº¦</p>
                    </div>
                    <div class="module-item" onclick="selectModule('prediction')">
                        <h4 class="font-bold">é¢„æµ‹æ¨¡å—</h4>
                        <p class="text-sm text-gray-400">è§£é”é‡å­é¢„æµ‹åŠŸèƒ½</p>
                    </div>
                </div>
                <div class="mt-4 flex justify-end gap-2">
                    <button class="action-button" onclick="closeModuleSelector()">å…³é—­</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Three.js åœºæ™¯è®¾ç½®
        let scene, camera, renderer, obelisk;
        let isRotating = true;
        let quantumMode = false;
        let computeProgress = 0;
        let currentFunction = 'research';
        let currentUpgrade = 0;

        function initThreeJS() {
            const container = document.getElementById('model-container');
            const width = container.clientWidth;
            const height = container.clientHeight;

            // åˆ›å»ºåœºæ™¯
            scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0x0f172a, 10, 50);

            // åˆ›å»ºç›¸æœº
            camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
            camera.position.set(15, 10, 15);
            camera.lookAt(0, 0, 0);

            // åˆ›å»ºæ¸²æŸ“å™¨
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(width, height);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            container.appendChild(renderer.domElement);

            // æ·»åŠ ç¯å…‰
            const ambientLight = new THREE.AmbientLight(0x404040, 0.5);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(10, 20, 10);
            directionalLight.castShadow = true;
            scene.add(directionalLight);

            // åˆ›å»ºé‡å­å…‰æ•ˆ
            for (let i = 0; i < 4; i++) {
                const pointLight = new THREE.PointLight(0x10b981, 0.5, 15);
                pointLight.position.set(
                    Math.cos(i * Math.PI / 2) * 5,
                    5,
                    Math.sin(i * Math.PI / 2) * 5
                );
                scene.add(pointLight);
            }

            // åˆ›å»ºåœ°é¢
            const groundGeometry = new THREE.PlaneGeometry(30, 30);
            const groundMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x1e293b,
                roughness: 0.8,
                metalness: 0.2
            });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = -Math.PI / 2;
            ground.receiveShadow = true;
            scene.add(ground);

            // åˆ›å»ºæ–¹å°–ç¢‘
            createObelisk();

            // å¼€å§‹åŠ¨ç”»å¾ªç¯
            animate();

            // å“åº”çª—å£å¤§å°å˜åŒ–
            window.addEventListener('resize', onWindowResize);
        }

        function createObelisk() {
            obelisk = new THREE.Group();

            // åŸºåº§
            const baseGeometry = new THREE.BoxGeometry(6, 1, 6);
            const baseMaterial = new THREE.MeshPhongMaterial({
                color: 0x10b981,
                emissive: 0x059669,
                emissiveIntensity: 0.2,
                metalness: 0.8,
                roughness: 0.2
            });
            const base = new THREE.Mesh(baseGeometry, baseMaterial);
            base.position.y = 0.5;
            base.castShadow = true;
            obelisk.add(base);

            // ä¸»ä½“ç»“æ„
            const bodyGeometry = new THREE.BoxGeometry(3, 8, 3);
            const bodyMaterial = new THREE.MeshPhongMaterial({
                color: 0x34d399,
                emissive: 0x10b981,
                emissiveIntensity: 0.3,
                metalness: 0.9,
                roughness: 0.1
            });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.position.y = 5;
            body.castShadow = true;
            obelisk.add(body);

            // é¡¶éƒ¨æ™¶ä½“
            const crystalGeometry = new THREE.OctahedronGeometry(1.5, 0);
            const crystalMaterial = new THREE.MeshPhongMaterial({
                color: 0x6ee7b7,
                emissive: 0x34d399,
                emissiveIntensity: 0.8,
                transparent: true,
                opacity: 0.9
            });
            const crystal = new THREE.Mesh(crystalGeometry, crystalMaterial);
            crystal.position.y = 10;
            crystal.castShadow = true;
            obelisk.add(crystal);

            // é‡å­ç¯
            for (let i = 0; i < 4; i++) {
                const ringGeometry = new THREE.TorusGeometry(2.5, 0.1, 8, 32);
                const ringMaterial = new THREE.MeshPhongMaterial({
                    color: 0x10b981,
                    emissive: 0x34d399,
                    emissiveIntensity: 0.6,
                    transparent: true,
                    opacity: 0.8
                });
                const ring = new THREE.Mesh(ringGeometry, ringMaterial);
                ring.position.y = 2 + i * 2;
                ring.rotation.x = Math.PI / 2;
                ring.name = `quantum-ring-${i}`;
                obelisk.add(ring);
            }

            // æ•°æ®èŠ‚ç‚¹
            for (let i = 0; i < 8; i++) {
                const nodeGeometry = new THREE.SphereGeometry(0.2, 8, 8);
                const nodeMaterial = new THREE.MeshBasicMaterial({
                    color: 0x6ee7b7,
                    emissive: 0x10b981
                });
                const node = new THREE.Mesh(nodeGeometry, nodeMaterial);
                const angle = i * Math.PI / 4;
                const radius = 1.8;
                node.position.x = Math.cos(angle) * radius;
                node.position.z = Math.sin(angle) * radius;
                node.position.y = 5;
                obelisk.add(node);
            }

            scene.add(obelisk);
        }

        function animate() {
            requestAnimationFrame(animate);

            // æ—‹è½¬æ–¹å°–ç¢‘
            if (isRotating && obelisk) {
                obelisk.rotation.y += 0.002;
                
                // æ—‹è½¬é‡å­ç¯
                obelisk.children.forEach((child, index) => {
                    if (child.name && child.name.startsWith('quantum-ring-')) {
                        child.rotation.z += 0.01 * (index % 2 === 0 ? 1 : -1);
                    }
                });
                
                // è„‰åŠ¨é¡¶éƒ¨æ™¶ä½“
                const crystal = obelisk.children.find(child => child.geometry instanceof THREE.OctahedronGeometry);
                if (crystal) {
                    const scale = 1 + Math.sin(Date.now() * 0.003) * 0.2;
                    crystal.scale.setScalar(scale);
                    
                    if (quantumMode) {
                        crystal.material.emissiveIntensity = 1.5;
                    }
                }
            }

            // é‡å­æ¨¡å¼æ•ˆæœ
            if (quantumMode) {
                // å¢å¼ºå‘å…‰
                obelisk.children.forEach(child => {
                    if (child.material && child.material.emissive) {
                        child.material.emissiveIntensity = Math.min(1, child.material.emissiveIntensity + 0.01);
                    }
                });
            }

            // æ›´æ–°è®¡ç®—è¿›åº¦
            if (computeProgress < 100) {
                computeProgress += 0.2;
                updateComputeDisplay();
            }

            renderer.render(scene, camera);
        }

        function onWindowResize() {
            const container = document.getElementById('model-container');
            const width = container.clientWidth;
            const height = container.clientHeight;

            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        }

        // æ§åˆ¶å‡½æ•°
        function toggleRotation() {
            isRotating = !isRotating;
            document.getElementById('rotation-text').textContent = isRotating ? 'æš‚åœæ—‹è½¬' : 'å¼€å§‹æ—‹è½¬';
        }

        function toggleQuantumMode() {
            quantumMode = !quantumMode;
            document.getElementById('quantum-text').textContent = quantumMode ? 'æ™®é€šæ¨¡å¼' : 'é‡å­æ¨¡å¼';
            
            if (quantumMode) {
                createQuantumEffects();
            }
        }

        function createQuantumEffects() {
            const container = document.getElementById('model-container');
            
            setInterval(() => {
                if (quantumMode) {
                    const effect = document.createElement('div');
                    effect.className = 'quantum-effect';
                    effect.style.left = Math.random() * 100 + '%';
                    effect.style.top = Math.random() * 100 + '%';
                    container.appendChild(effect);
                    
                    setTimeout(() => effect.remove(), 2000);
                }
            }, 500);
        }

        function openModuleSelector(slot) {
            document.getElementById('module-selector').classList.remove('hidden');
            // è¿™é‡Œå¯ä»¥æ ¹æ®slotæ˜¾ç¤ºå¯¹åº”çš„æ¨¡å—åˆ—è¡¨
        }

        function closeModuleSelector() {
            document.getElementById('module-selector').classList.add('hidden');
        }

        function selectModule(moduleType) {
            // æ›´æ–°æ¨¡å—é€‰æ‹©
            document.querySelectorAll('.module-item').forEach(item => {
                item.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // æ›´æ–°å·²è£…å¤‡æ¨¡å—æ•°é‡
            const count = document.querySelectorAll('.module-slot.equipped').length;
            document.getElementById('equipped-count').textContent = count;
        }

        function startComputation() {
            computeProgress = 0;
            const complexity = document.getElementById('complexity').value;
            const speeds = { simple: 2, medium: 1.5, complex: 1, quantum: 0.5 };
            
            const interval = setInterval(() => {
                computeProgress += speeds[complexity];
                if (computeProgress >= 100) {
                    computeProgress = 100;
                    clearInterval(interval);
                    completeComputation();
                }
                updateComputeDisplay();
            }, 100);
        }

        function updateComputeDisplay() {
            document.getElementById('compute-bar').style.width = computeProgress + '%';
            document.getElementById('compute-percent').textContent = Math.round(computeProgress) + '%';
        }

        function completeComputation() {
            // è®¡ç®—å®Œæˆæ•ˆæœ
            const container = document.getElementById('model-container');
            
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const stream = document.createElement('div');
                    stream.className = 'data-stream';
                    stream.style.left = '50%';
                    stream.style.top = '20%';
                    stream.style.transform = `translateX(${(i - 2) * 20}px)`;
                    container.appendChild(stream);
                    
                    setTimeout(() => stream.remove(), 2000);
                }, i * 100);
            }
        }

        function updateComplexity() {
            // æ ¹æ®å¤æ‚åº¦æ›´æ–°æ˜¾ç¤º
        }

        function switchFunction(mode) {
            currentFunction = mode;
            document.querySelectorAll('.function-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // æ›´æ–°åŠŸèƒ½å†…å®¹
            const content = document.getElementById('function-content');
            const functions = {
                research: {
                    title: 'ç ”ç©¶æ¨¡å¼',
                    desc: 'åŠ é€Ÿç§‘æŠ€ç ”ç©¶ï¼Œæä¾›ç ”ç©¶ç‚¹æ•°åŠ æˆ',
                    stats: { speed: '+50%', efficiency: '85%' }
                },
                defense: {
                    title: 'é˜²å¾¡æ¨¡å¼',
                    desc: 'æ¿€æ´»é˜²å¾¡ç³»ç»Ÿï¼Œæä¾›æŠ¤ç›¾å’Œååˆ¶èƒ½åŠ›',
                    stats: { shield: '+40%', range: '200m' }
                },
                communication: {
                    title: 'é€šè®¯æ¨¡å¼',
                    desc: 'æ‰©å±•é€šè®¯ç½‘ç»œï¼Œå¢å¼ºä¿¡æ¯ä¼ é€’æ•ˆç‡',
                    stats: { range: '+300%', speed: '+25%' }
                },
                engineering: {
                    title: 'å·¥ç¨‹æ¨¡å¼',
                    desc: 'æå‡å»ºç­‘å’Œç»´ä¿®æ•ˆç‡ï¼Œä¼˜åŒ–èµ„æºåˆ©ç”¨',
                    stats: { build: '+60%', repair: '+80%' }
                }
            };
            
            const func = functions[mode];
            content.innerHTML = `
                <h4 class="font-bold mb-2">${func.title}</h4>
                <p class="text-sm text-gray-400 mb-3">${func.desc}</p>
                <div class="grid grid-cols-2 gap-2 text-sm">
                    ${Object.entries(func.stats).map(([key, value]) => `
                        <div>
                            <span class="text-gray-400">${key === 'speed' ? 'é€Ÿåº¦:' : key === 'efficiency' ? 'æ•ˆç‡:' : 
                                key === 'shield' ? 'æŠ¤ç›¾:' : key === 'range' ? 'èŒƒå›´:' : 
                                key === 'build' ? 'å»ºé€ :' : 'ç»´ä¿®:'}</span>
                            <span class="text-green-400">${value}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function runPrediction() {
            // æ¨¡æ‹Ÿé¢„æµ‹è¿‡ç¨‹
            const button = event.target;
            button.disabled = true;
            button.textContent = 'é¢„æµ‹ä¸­...';
            
            setTimeout(() => {
                button.disabled = false;
                button.textContent = 'è¿è¡Œé¢„æµ‹';
                
                // æ›´æ–°é¢„æµ‹ç»“æœ
                updatePredictionResults();
            }, 2000);
        }

        function updatePredictionResults() {
            // è¿™é‡Œå¯ä»¥æ›´æ–°é¢„æµ‹ç»“æœçš„æ˜¾ç¤º
        }

        currentUpgrade = 0;
        const upgradeData = [
            { title: 'T1 - åŸºç¡€æ–¹å°–ç¢‘', desc: 'æ ‡å‡†çš„æ¨¡å—åŒ–æ–¹å°–ç¢‘', cost: '2000 å½¢é­„', slots: 2 },
            { title: 'T2 - é«˜çº§æ–¹å°–ç¢‘', desc: 'å¢åŠ æ¨¡å—æ’æ§½å’Œè®¡ç®—èƒ½åŠ›', cost: '4000 å½¢é­„', slots: 4 },
            { title: 'T3 - é‡å­æ–¹å°–ç¢‘', desc: 'è§£é”é‡å­è®¡ç®—å’Œé«˜çº§æ¨¡å—', cost: '8000 å½¢é­„', slots: 6 }
        ];

        function selectUpgrade(level) {
            currentUpgrade = level;
            document.querySelectorAll('.upgrade-node').forEach((node, index) => {
                node.classList.toggle('active', index === level);
            });
            
            const upgrade = upgradeData[level];
            document.getElementById('upgrade-title').textContent = upgrade.title;
            document.getElementById('upgrade-desc').textContent = upgrade.desc;
            document.getElementById('upgrade-cost').textContent = upgrade.cost;
            
            // æ›´æ–°å‚æ•°
            const health = [2000, 3000, 5000][level];
            document.getElementById('health-bar').style.width = '100%';
            document.getElementById('health-text').textContent = `${health}/${health}`;
        }

        // åˆå§‹åŒ–
        window.addEventListener('load', () => {
            initThreeJS();
        });
    </script>
</body>
</html>